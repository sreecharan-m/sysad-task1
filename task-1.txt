#initialising all scripts with alias and downloading files and crontab


//////////////////////////////////////////////////////////////////////////////////////// subtask1.sh ///////////////////////////////////////////////////////////////////

#!/bin/bash
sudo useradd -m ChiefCommander
sudo useradd -m ArmyGeneral
sudo useradd -m NavyMarshal
sudo useradd -m AirforceChief
troop=(Army Navy AirForce)
for j in {0..2}
do
for i in {1..50}
do
sudo useradd -m ${troop[j]}$i
done
done
touch /home/ChiefCommander/attendance_report /home/ChiefCommander/hacker1.sh /home/ChiefCommander/hacker2.sh
touch /home/ChiefCommander/nearest10
touch /home/Army$i/post_allotted.txt /home/Navy$i/post_allotted.txt /home/Airforce$i/post_allotted.txt
wget https://inductions.delta.nitt.edu/sysad-task1-position.log
https://inductions.delta.nitt.edu/sysad-task1-attendance.log 
0 0 * * * subtask3.sh 
0 6 * * * subtask4.sh
0 0 * * * hacker1.sh


alias userGenerate='bash ./subtask1.sh'
alias permit='bash ./subtask2.sh'
alias autoSchedule='bash ./subtask3.sh'
alias attendance='bash ./subtask4.sh'
alias record1='bash /home/ArmyGeneral/./subtask51.sh'
alias record2='bash /home/NavyMarshal/./subtask52.sh'
alias record3='bash /home/AirforceChief/./subtask52.sh'
alias finalattendance='bash /home/ChiefCommander/./hacker1.sh'
alias nearest='bash /home/ChiefCommander/./hacker2.sh'

//////////////////////////////////////////////////////////////////////////////////////// subtask2.sh //////////////////////////////////////////////////////////////////////

#!/bin/bash
troop=(Army Navy AirForce)
chiefs=(ArmyGeneral NavyMarshal AirforceChief)
for j in {0..2}
do
for i in {1..50}
do
sudo chmod -R 770 /home/${troop[j]}$i
sudo usermod -a -G ${troop[j]}$i ${chief[j]}
done
done

/////////////////////////////////////////////////////////////////////////////////////// subtask3.sh /////////////////////////////////////////////////////////////////////////

#!/bin/bash
for i in {1..50}
do
d=$(date +%F)
grep "$d" sysad-task1-position.log | grep "Army$i" | awk '{ print $1 "|" $3 $4}' > /home/Army$i/post_allotted.txt
grep "$d" sysad-task1-position.log | grep "Navy$i" | awk '{ print $1 "|" $3 $4}' > /home/Navy$i/post_allotted.txt
grep "$d" sysad-task1-position.log | grep "AirForce$i" | awk '{ print $1 "|" $3 $4}' > /home/Airforce$i/post_allotted.txt
done

////////////////////////////////////////////////////////////////////////////////////// subtask4.sh /////////////////////////////////////////////////////////////////////////

#!/bin/bash
#!/bin/bash
d=$(date +%F)
touch /home/ArmyGeneral/attendence_record /home/NavyMarshal/attendence_record /home/AirforceChief/attendence_record
grep "$d" sysad-task1-attendance.log | grep "Army" | grep "yes" | awk '{ print $2}' > /home/ArmyGeneral/attendence_record
grep "$d" sysad-task1-attendance.log | grep "Navy" | grep "yes" | awk '{ print $2}' > /home/NavyMarshal/attendence_record
grep "$d" sysad-task1-attendance.log | grep "AirForce" | grep "yes" | awk '{ print $2}' > /home/AirforceChief/attendence_record

////////////////////////////////////////////////////////////////////////////////////// subtask51.sh - ArmyGeneral //////////////////////////////////////////////////////////////////////////

#!/bin/bash
d=$(date +%F -d 'last sunday - ($1) day)
echo " grep "$d" sysad-task1-attendance.log | grep "Army" "

////////////////////////////////////////////////////////////////////////////////////// subtask52.sh - Navymarshal ///////////////////////////////////////////////////////////////////////////

#!/bin/bash
d=$(date +%F -d 'last sunday - $1 day)
echo "grep "$d" sysad-task1-attendance.log | grep "Navy" "

////////////////////////////////////////////////////////////////////////////////////// subtask53.sh - AirforceChief ////////////////////////////////////////////////////////////////////////////

#!/bin/bash
d=$(date +%F -d 'last sunday - $1 day)
echo "grep "$d" sysad-task1-attendance.log | grep "AirForce" "

////////////////////////////////////////////////////////////////////////////////////// Hacker ////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////// hacker1.sh

#added crontab to ensure that whenever he opens he will get the attendence report from start to the day he is opening 
d=$(date +%F)
grep "$d" sysad-task1-attendance.log | grep "YES" >> /home/ChiefCommander/attendance_report

///////////////////////////////////////////////////////////////////////////////////// hacker2.sh

#!/bin/sh
paste sysad-task1-position.log sysad-task1-attendance.log > position2.log
d=d=$(date +%F)
grep "$d" position2.log | grep "Army" | grep "YES" | awk '{ print $3 " " $4 }' > temp.txt
grep "$d" position2.log | grep "Army" | grep "YES" | awk '{ print $2 }' > armyid.txt
sed 's/N//' test4.txt | sed 's/E//' | sed 's/Â°//g' > temp2.txt
awk '{ print ($1/57.3) " " ($2/57.3) }' tem2.txt > temp3.txt
awk '{ var=0.47*sin($1) + 0.877*cos($1)*cos($2-1.34); print var }' temp3.txt > temp4.txt
awk '{ dis=3693*atan2((1.-($1)^2)^0.5,($1)); print dis }' temp4.txt > temp5.txt
paste armyid.txt temp5.txt > armywithdist.txt
sort -k -2n armywithdist.txt | head > /home/ChiefCommander/nearest10.txt
